# 一、整體設計目標（明確定義）

### 你要的是這種公告系統：

* 一則公告 = 一張卡片
* 由 `.json` 控制：

  * 置頂
  * 類型
  * 發布時間
  * 標題 / 摘要 / 內容
* 預設只顯示「裁示內容」
* 點擊「顯示全部」看完整內容
* 外觀與行為接近部落格，但語意仍是「公告」

👉 **不是 Blog CMS，而是「公告 Feed」**

---

# 二、公告卡片應包含的基本欄位（定稿）

### 卡片資訊層級（由上到下）

1. **標籤（Badge）**

   * 類型（營運公告 / 活動公告 …）
   * 置頂標示（如有）

2. **標題（主旨）**

3. **發布時間**

4. **裁示內容（摘要）**

   * 固定高度
   * 超過即截斷

5. **互動**
   -「顯示全部」 / 「收合」

---

# 三、公告類型建議（給你一組可長期使用的分類）

### ✅ 建議預設 4 種（夠用、不會太細）

| type key    | 顯示名稱 | 用途           |
| ----------- | ---- | ------------ |
| `operation` | 營運公告 | 營業時間、門市異動、颱風 |
| `event`     | 活動公告 | 促銷、節慶活動      |
| `system`    | 系統通知 | 官網維護、服務異常    |
| `general`   | 一般公告 | 其他不適合分類者     |

👉 技術上可擴充，但**一開始不要超過 5 種**

---

# 四、JSON 結構設計（核心）

### `news/news.json`（完整建議格式）

```json
[
  {
    "id": "2026-cny",
    "title": "2026 春節營業時間公告",
    "type": "operation",
    "date": "2026-01-29",
    "pinned": true,

    "excerpt": "春節期間各門市營業時間有所調整，除夕全門市營業至 18:00，初一至初四部分門市正常營業。",

    "content": "posts/2026-cny.html"
  },
  {
    "id": "feb-event",
    "title": "2 月會員滿額贈活動",
    "type": "event",
    "date": "2026-02-01",
    "pinned": false,

    "excerpt": "2 月限定會員活動，消費滿額即可獲得指定贈品，數量有限。",

    "content": "posts/feb-event.html"
  }
]
```

---

## 📌 設計重點

* `pinned: true` → 置頂
* `excerpt` **只放純文字**
* `content` 指向完整 HTML（或 md）

---

# 五、卡片顯示行為規則（定義清楚，避免之後混亂）

### 排序規則（非常重要）

1. `pinned = true` 永遠在最上面
2. 其餘依 `date` 新 → 舊

---

### 摘要顯示規則

* 使用 **CSS 行數限制（非 JS 切字）**
* 建議：

  * 桌機：3 行
  * 行動：4 行

---

# 六、HTML 結構（卡片）

```html
<article class="news-card pinned operation">
  <div class="meta">
    <span class="badge">營運公告</span>
    <span class="pin">置頂</span>
    <time>2026-01-29</time>
  </div>

  <h3 class="title">2026 春節營業時間公告</h3>

  <p class="excerpt">
    春節期間各門市營業時間有所調整，除夕全門市營業至 18:00，初一至初四部分門市正常營業。
  </p>

  <button class="toggle">顯示全部</button>

  <div class="full-content hidden">
    <!-- fetch posts/2026-cny.html 後插入 -->
  </div>
</article>
```

---

# 七、CSS 關鍵（摘要裁切 + 樣式）

```css
.excerpt {
  display: -webkit-box;
  -webkit-line-clamp: 3;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

.news-card {
  border: 1px solid #ddd;
  padding: 20px;
  margin-bottom: 24px;
}

.badge {
  font-size: 0.85em;
  padding: 2px 8px;
}

.news-card.operation .badge { background: #eef3ff; }
.news-card.event .badge { background: #fff4dc; }
.news-card.system .badge { background: #f5f5f5; }

.pinned {
  border-width: 2px;
}
```

---

# 八、JS 行為（核心邏輯，簡化版）

```js
async function renderNews() {
  const res = await fetch("/news/news.json");
  let items = await res.json();

  items.sort((a, b) => {
    if (a.pinned !== b.pinned) return b.pinned - a.pinned;
    return new Date(b.date) - new Date(a.date);
  });

  // 依 items 動態生成卡片（略）
}

async function toggleContent(card, item) {
  const box = card.querySelector(".full-content");

  if (!box.dataset.loaded) {
    const html = await fetch(`/news/${item.content}`).then(r => r.text());
    box.innerHTML = html;
    box.dataset.loaded = "1";
  }

  box.classList.toggle("hidden");
}
```

---

# 九、實際維護流程（給未來的人）

### 新增公告只需：

1. 新增 `posts/xxx.html`
2. 在 `news.json` 加一筆
3. 視需要設 `pinned: true`

**不改 HTML、不改 JS、不改 CSS**

---

# 十、總結（一句話版本）

> 這是一個 **JSON 驅動的公告 Feed 系統**：
> 卡片顯示摘要、可展開全文、支援分類與置頂，
> 行為像部落格，但語意仍是「公告」。
